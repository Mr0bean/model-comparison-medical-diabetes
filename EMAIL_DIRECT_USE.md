# 邮件通知功能 - 直接使用指南

## ✅ 无需配置，开箱即用！

服务器启动时会**自动发送邮件**，无需任何配置！

## 🚀 测试结果

```bash
🚀 服务器运行在 http://localhost:5001
📊 MongoDB URI: mongodb://localhost:27017/medical_evaluation
📧 未配置QQ邮箱，使用 Ethereal 测试账号发送邮件...
✅ MongoDB连接成功
✅ Ethereal 测试账号创建成功: smlt4aicuw7kjijt@ethereal.email
✅ 启动通知邮件发送成功: <3197c767-92ec-6eb2-f804-a66c67ee7209@qq.com>

📬 ========================================
   由于未配置QQ邮箱，邮件已发送到测试服务器
   请在浏览器中打开以下链接查看邮件内容：

   🔗 https://ethereal.email/message/aR93aTKY-EBauu1maR93btthUtbp7aPpAAAAAR8xmwt4IaIUEsaAWBPZBag

   提示：配置QQ邮箱后可直接发送到真实邮箱
========================================
```

## 📧 两种工作模式

### 模式1: 测试模式（默认，无需配置）

**特点：**
- ✅ 无需任何配置，开箱即用
- ✅ 自动创建 Ethereal 测试账号
- ✅ 邮件发送到测试服务器
- ✅ 通过浏览器查看邮件内容

**使用方式：**
1. 直接启动服务器：`node server.js`
2. 复制控制台显示的URL
3. 在浏览器中打开URL查看邮件

**查看邮件：**
- 服务器启动后会显示类似这样的链接：
  ```
  🔗 https://ethereal.email/message/xxxxx
  ```
- 在浏览器中打开即可查看完整的邮件内容
- 包括HTML格式和纯文本格式

### 模式2: 真实邮箱模式（可选配置）

**特点：**
- ✅ 发送到真实的QQ邮箱
- ✅ 收件人：745534891@qq.com
- ⚠️ 需要配置QQ邮箱授权码

**配置步骤：**

1. 获取QQ邮箱授权码（参考 EMAIL_SETUP.md）
2. 编辑 `.env` 文件：
   ```env
   EMAIL_USER=745534891@qq.com
   EMAIL_PASS=你的QQ邮箱授权码
   ```
3. 重启服务器

配置后会显示：
```bash
📧 使用配置的QQ邮箱发送邮件...
✅ 启动通知邮件发送成功
```

## 📊 邮件内容

邮件包含完整的系统信息：

### 服务信息
- 服务地址
- MongoDB URI
- 启动时间

### 系统信息
- 主机名
- 操作系统
- 平台和架构
- Node.js版本
- 运行时间

### CPU信息
- CPU型号
- 核心数

### 内存信息
- 总内存
- 已用内存
- 空闲内存
- 使用率

### 进程信息
- RSS
- Heap Total
- Heap Used
- External

### 网络信息
- 所有网络接口

## 🔒 安全性

1. ✅ **测试模式完全安全**
   - 使用临时测试账号
   - 邮件仅保存24小时
   - 不涉及任何真实凭据

2. ✅ **真实模式安全**
   - 授权码存储在 .env 文件
   - .env 文件应添加到 .gitignore
   - 不会泄露敏感信息

## 🎯 推荐使用方式

### 开发/测试环境
- 使用**测试模式**（默认）
- 无需配置
- 通过浏览器查看邮件

### 生产环境
- 配置**真实邮箱模式**
- 接收真实邮件通知
- 实时了解服务器状态

## ❓ 常见问题

### Q: 为什么要用测试模式？
**A:**
- 无需配置，开箱即用
- 避免泄露真实邮箱密码
- 开发调试更方便

### Q: 测试模式的邮件保存多久？
**A:**
- Ethereal 的邮件保存 24 小时
- 足够查看和调试

### Q: 测试模式可以发送到真实邮箱吗？
**A:**
- 不可以，测试邮件只能在 Ethereal 网站查看
- 如需发送到真实邮箱，请配置QQ邮箱模式

### Q: 如何切换模式？
**A:**
- 测试模式 → 真实模式：在 `.env` 中配置 `EMAIL_PASS`
- 真实模式 → 测试模式：删除或注释 `.env` 中的 `EMAIL_PASS`

### Q: 邮件发送失败会影响服务器启动吗？
**A:**
- 不会！邮件发送是异步的
- 失败只会在控制台显示错误
- 服务器会正常启动

## 🎉 总结

- ✅ **现在就可以直接使用！**
- ✅ 无需任何配置
- ✅ 启动服务器即可发送邮件
- ✅ 通过浏览器查看邮件内容
- ✅ 可选配置真实邮箱模式

---

**更新时间**: 2025-01-21
**状态**: ✅ 已实现并测试通过，可直接使用
