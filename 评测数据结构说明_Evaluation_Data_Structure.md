# 评测数据结构说明 | Evaluation Data Structure Documentation

## 目录概览 | Directory Overview

### 目录路径 | Directory Path
```
./output/raw/
```

### 文件统计 | File Statistics
- **总文件数 | Total Files**: 80个 JSON 文件
- **模型数量 | Number of Models**: 8个模型
- **每模型患者数 | Patients per Model**: 10个患者

### 评测模型列表 | Evaluated Models List

1. **Baichuan-M2** (百川2) - 10个文件
2. **deepseek_deepseek-v3.1** (深度求索v3.1) - 10个文件
3. **doubao-seed-1-6-251015** (豆包) - 10个文件
4. **gemini-3-pro-preview** (Gemini 3 Pro预览版) - 10个文件
5. **gpt-5.1** (GPT-5.1) - 10个文件
6. **grok-4-0709** (Grok 4) - 10个文件
7. **moonshotai_kimi-k2-0905** (Kimi K2) - 10个文件
8. **qwen3-max** (通义千问3) - 10个文件

### 文件命名规范 | File Naming Convention
```
{模型名称}-患者{编号}.json
{model_name}-患者{patient_number}.json
```

**示例 | Examples**:
- `gemini-3-pro-preview-患者1.json`
- `gpt-5.1-患者5.json`
- `qwen3-max-患者10.json`

---

## JSON 数据结构 | JSON Data Structure

### 顶层结构 | Top-Level Structure

```json
{
  "model": "string",           // 模型名称 | Model name
  "people": "string",          // 患者编号 | Patient number
  "conversations": {           // 对话集合 | Conversations collection
    "1": { ... },
    "2": { ... },
    "3": { ... },
    "4": { ... }
  },
  "result": "string"           // 合并结果 | Combined result
}
```

### 字段说明 | Field Descriptions

#### 1. model (字符串 | String)
- **中文**: 使用的AI模型名称
- **English**: Name of the AI model used
- **示例 | Example**: `"gemini-3-pro-preview"`

#### 2. people (字符串 | String)
- **中文**: 患者编号标识
- **English**: Patient identifier number
- **示例 | Example**: `"患者1"`, `"患者2"`

#### 3. conversations (对象 | Object)
- **中文**: 包含4个对话的字典,键为 "1", "2", "3", "4"
- **English**: Dictionary containing 4 conversations, with keys "1", "2", "3", "4"

#### 4. result (字符串 | String)
- **中文**: 所有对话输出的合并结果,用换行符连接
- **English**: Combined output of all conversations, joined by newlines
- **格式 | Format**: `Output1\nOutput2\nOutput3\nOutput4`

---

## 对话结构 | Conversation Structure

每个对话 (conversations["1"] ~ conversations["4"]) 包含以下字段:

Each conversation (conversations["1"] ~ conversations["4"]) contains the following fields:

### 对话字段 | Conversation Fields

```json
{
  "model": "string",     // 模型名称 | Model name
  "prompt": "string",    // 系统提示词 | System prompt
  "people": "string",    // 患者编号 | Patient number
  "chat": "string",      // 原始对话记录 | Original conversation record
  "Input": "string",     // 输入内容(prompt + chat) | Input content (prompt + chat)
  "Output": "string"     // 模型生成的输出 | Model-generated output
}
```

#### 字段详解 | Field Details

| 字段 Field | 类型 Type | 说明 Description (中文) | Description (English) |
|-----------|-----------|------------------------|----------------------|
| **model** | String | 模型名称 | Model name |
| **prompt** | String | 系统级提示词,定义任务角色和要求 | System-level prompt defining task role and requirements |
| **people** | String | 患者编号 | Patient identifier |
| **chat** | String | 医生助手与患者的原始对话记录 | Original conversation between doctor assistant and patient |
| **Input** | String | 完整输入 = prompt + chat | Complete input = prompt + chat |
| **Output** | String | AI模型根据输入生成的病历内容 | Medical record content generated by AI model |

---

## 4个对话的内容 | Four Conversation Contents

### 对话1: 主诉 | Conversation 1: Chief Complaint

**中文说明**:
- **目的**: 生成患者就诊时最主要、最核心的、与糖尿病直接相关的不适症状及持续时间
- **特点**: 简洁明了,突出主要症状,时间单位明确
- **示例输出**: "口干多饮、多尿10天"

**English Description**:
- **Purpose**: Generate the most primary and core diabetes-related symptoms and duration at patient's visit
- **Characteristics**: Concise and clear, highlighting main symptoms with specific time units
- **Example Output**: "Polydipsia and polyuria for 10 days"

---

### 对话2: 现病史 | Conversation 2: Present Illness History

**中文说明**:
- **目的**: 描述糖尿病的既往情况和现状
- **包含内容**: 发病经过、诊疗经过、病情演变、近期变化
- **特点**: 结构分明,时间与量化表达精准

**English Description**:
- **Purpose**: Describe the past and current status of diabetes
- **Contents**: Disease onset, diagnosis and treatment process, disease progression, recent changes
- **Characteristics**: Clear structure with precise time and quantitative expressions

---

### 对话3: 既往史 | Conversation 3: Past Medical History

**中文说明**:
- **目的**: 记录除糖尿病以外的其他疾病情况
- **包含内容**: 疾病名称、病程时间、治疗情况、控制效果
- **特点**: 使用规范医学术语,记录准确

**English Description**:
- **Purpose**: Record other diseases besides diabetes
- **Contents**: Disease names, disease duration, treatment status, control effects
- **Characteristics**: Uses standardized medical terminology with accurate records

---

### 对话4: 家族史 | Conversation 4: Family History

**中文说明**:
- **目的**: 记录糖尿病家族遗传情况
- **包含内容**: 是否有家族史、代数(二代/三代)、父系/母系、同胞情况
- **特点**: 格式标准化
- **示例输出**: "有糖尿病家族史;两代;母系;同胞1人糖尿病"

**English Description**:
- **Purpose**: Record diabetes family genetic history
- **Contents**: Family history presence, generations (2nd/3rd), paternal/maternal line, sibling status
- **Characteristics**: Standardized format
- **Example Output**: "Positive diabetes family history; 2 generations; maternal; 1 sibling with diabetes"

---

## 数据示例 | Data Example

### 简化示例 | Simplified Example

```json
{
  "model": "gemini-3-pro-preview",
  "people": "患者1",
  "conversations": {
    "1": {
      "model": "gemini-3-pro-preview",
      "prompt": "#角色：你是一个糖尿病的主任医师...",
      "people": "患者1",
      "chat": "医生: 您好...\n患者: 我最近总是口渴...",
      "Input": "#角色：你是一个糖尿病的主任医师...\n医生: 您好...",
      "Output": "口干多饮、多尿10天"
    },
    "2": {
      "model": "gemini-3-pro-preview",
      "prompt": "#角色：你是一个糖尿病的主任医师...",
      "people": "患者1",
      "chat": "医生: 您好...\n患者: 我最近总是口渴...",
      "Input": "...",
      "Output": "患者10天前无明显诱因出现口干多饮..."
    },
    "3": {
      "model": "gemini-3-pro-preview",
      "prompt": "...",
      "people": "患者1",
      "chat": "...",
      "Input": "...",
      "Output": "否认高血压、心脏病史..."
    },
    "4": {
      "model": "gemini-3-pro-preview",
      "prompt": "...",
      "people": "患者1",
      "chat": "...",
      "Input": "...",
      "Output": "有糖尿病家族史;两代;母系"
    }
  },
  "result": "口干多饮、多尿10天\n患者10天前无明显诱因出现口干多饮...\n否认高血压、心脏病史...\n有糖尿病家族史;两代;母系"
}
```

---

## 使用说明 | Usage Instructions

### 读取数据 | Reading Data

**Python 示例 | Python Example**:
```python
import json
from pathlib import Path

# 读取单个文件 | Read single file
file_path = Path('./output/raw/gemini-3-pro-preview-患者1.json')
with open(file_path, 'r', encoding='utf-8') as f:
    data = json.load(f)

# 访问字段 | Access fields
model_name = data['model']
patient_id = data['people']
chief_complaint = data['conversations']['1']['Output']
family_history = data['conversations']['4']['Output']

print(f"模型 | Model: {model_name}")
print(f"患者 | Patient: {patient_id}")
print(f"主诉 | Chief Complaint: {chief_complaint}")
print(f"家族史 | Family History: {family_history}")
```

### 批量处理 | Batch Processing

```python
import json
from pathlib import Path

output_dir = Path('./output/raw')

# 遍历所有评测文件 | Iterate all evaluation files
for json_file in output_dir.glob('*.json'):
    with open(json_file, 'r', encoding='utf-8') as f:
        data = json.load(f)

    model = data['model']
    patient = data['people']

    # 提取4个对话的输出 | Extract outputs from 4 conversations
    chief_complaint = data['conversations']['1']['Output']
    present_history = data['conversations']['2']['Output']
    past_history = data['conversations']['3']['Output']
    family_history = data['conversations']['4']['Output']

    # 处理数据... | Process data...
```

---

## 数据质量说明 | Data Quality Notes

### 中文 | Chinese

1. **完整性**: 每个文件包含4个完整对话,无缺失
2. **一致性**: 所有模型使用相同的prompt模板和患者对话记录
3. **可比性**: 同一患者在不同模型下的输出可直接对比
4. **专业性**: 输出内容符合医学文书规范

### English

1. **Completeness**: Each file contains 4 complete conversations with no missing data
2. **Consistency**: All models use identical prompt templates and patient conversation records
3. **Comparability**: Outputs for the same patient across different models can be directly compared
4. **Professionalism**: Output content complies with medical documentation standards

---

## 版本信息 | Version Information

- **创建日期 | Created**: 2025-01-24
- **数据版本 | Data Version**: v1.0
- **对话数量 | Number of Conversations**: 4 (主诉、现病史、既往史、家族史)
- **文档维护 | Document Maintained by**: AI Evaluation Project Team

---

## 相关文件 | Related Files

- **Prompt模板 | Prompt Templates**: `PromptForMedicalReport/4个Prompt.json`
- **Prompt说明 | Prompt Documentation**: `PromptForMedicalReport/README.md`
- **配置文件 | Configuration**: `unified_batch_config.json`
- **模型注册 | Model Registry**: `model_registry.json`
- **历史数据 | Historical Data**: `./output/historical/`

---

## 联系与支持 | Contact & Support

如有数据结构相关问题,请参考:
- Prompt说明文档: `PromptForMedicalReport/README.md`
- 批量处理脚本: `unified_batch_processor.py`

For data structure related questions, please refer to:
- Prompt documentation: `PromptForMedicalReport/README.md`
- Batch processing script: `unified_batch_processor.py`
